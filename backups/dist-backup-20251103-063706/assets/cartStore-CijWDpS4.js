import{R as b}from"./index-BpjOl2gf.js";const x=s=>{let o;const t=new Set,e=(c,v)=>{const g=typeof c=="function"?c(o):c;if(!Object.is(g,o)){const S=o;o=v??(typeof g!="object"||g===null)?g:Object.assign({},o,g),t.forEach(f=>f(o,S))}},n=()=>o,a={setState:e,getState:n,getInitialState:()=>m,subscribe:c=>(t.add(c),()=>t.delete(c))},m=o=s(e,n,a);return a},E=(s=>s?x(s):x),O=s=>s;function P(s,o=O){const t=b.useSyncExternalStore(s.subscribe,b.useCallback(()=>o(s.getState()),[s,o]),b.useCallback(()=>o(s.getInitialState()),[s,o]));return b.useDebugValue(t),t}const _=s=>{const o=E(s),t=e=>P(o,e);return Object.assign(t,o),t},R=(s=>s?_(s):_);function H(s,o){let t;try{t=s()}catch{return}return{getItem:n=>{var r;const u=m=>m===null?null:JSON.parse(m,void 0),a=(r=t.getItem(n))!=null?r:null;return a instanceof Promise?a.then(u):u(a)},setItem:(n,r)=>t.setItem(n,JSON.stringify(r,void 0)),removeItem:n=>t.removeItem(n)}}const y=s=>o=>{try{const t=s(o);return t instanceof Promise?t:{then(e){return y(e)(t)},catch(e){return this}}}catch(t){return{then(e){return this},catch(e){return y(e)(t)}}}},T=(s,o)=>(t,e,n)=>{let r={storage:H(()=>localStorage),partialize:i=>i,version:0,merge:(i,h)=>({...h,...i}),...o},u=!1;const a=new Set,m=new Set;let c=r.storage;if(!c)return s((...i)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),t(...i)},e,n);const v=()=>{const i=r.partialize({...e()});return c.setItem(r.name,{state:i,version:r.version})},g=n.setState;n.setState=(i,h)=>(g(i,h),v());const S=s((...i)=>(t(...i),v()),e,n);n.getInitialState=()=>S;let f;const C=()=>{var i,h;if(!c)return;u=!1,a.forEach(l=>{var d;return l((d=e())!=null?d:S)});const p=((h=r.onRehydrateStorage)==null?void 0:h.call(r,(i=e())!=null?i:S))||void 0;return y(c.getItem.bind(c))(r.name).then(l=>{if(l)if(typeof l.version=="number"&&l.version!==r.version){if(r.migrate){const d=r.migrate(l.state,l.version);return d instanceof Promise?d.then(I=>[!0,I]):[!0,d]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,l.state];return[!1,void 0]}).then(l=>{var d;const[I,D]=l;if(f=r.merge(D,(d=e())!=null?d:S),t(f,!0),I)return v()}).then(()=>{p?.(f,void 0),f=e(),u=!0,m.forEach(l=>l(f))}).catch(l=>{p?.(void 0,l)})};return n.persist={setOptions:i=>{r={...r,...i},i.storage&&(c=i.storage)},clearStorage:()=>{c?.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>C(),hasHydrated:()=>u,onHydrate:i=>(a.add(i),()=>{a.delete(i)}),onFinishHydration:i=>(m.add(i),()=>{m.delete(i)})},r.skipHydration||C(),f||S},j=T,N=.08,k={REWASH10:.1,CLEAN20:.2},A=R()(j((s,o)=>({items:[],discountCode:"",discountPercentage:0,addItem:(t,e=1)=>s(n=>{const r=n.items.findIndex(u=>u.id===t.id&&u.service===t.service);if(r>=0){const u=[...n.items];return u[r].quantity+=e,{items:u}}else return{items:[...n.items,{...t,quantity:e}]}}),removeItem:(t,e)=>s(n=>({items:n.items.filter(r=>!(r.id===t&&r.service===e))})),updateQuantity:(t,e,n)=>s(r=>n<=0?{items:r.items.filter(a=>!(a.id===t&&a.service===e))}:{items:r.items.map(a=>a.id===t&&a.service===e?{...a,quantity:n}:a)}),clearCart:()=>s({items:[],discountCode:"",discountPercentage:0}),getSubtotal:()=>{const{items:t}=o();return t.reduce((e,n)=>e+n.price*n.quantity,0)},getTax:()=>{const t=o().getSubtotal(),e=o().getDiscount();return(t-e)*N},getDiscount:()=>{const{discountPercentage:t}=o();return o().getSubtotal()*t},getTotal:()=>{const t=o().getSubtotal(),e=o().getDiscount(),n=o().getTax();return t-e+n},getItemCount:()=>{const{items:t}=o();return t.reduce((e,n)=>e+n.quantity,0)},applyDiscount:t=>{const e=k[t.toUpperCase()];e&&s({discountCode:t.toUpperCase(),discountPercentage:e})},removeDiscount:()=>s({discountCode:"",discountPercentage:0})}),{name:"cart-storage"}));export{A as u};
//# sourceMappingURL=cartStore-CijWDpS4.js.map
